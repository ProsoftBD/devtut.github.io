(window.webpackJsonp=window.webpackJsonp||[]).push([[3430],{3776:function(t,e,s){"use strict";s.r(e);var a=s(19),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"object-oriented-vba"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#object-oriented-vba"}},[t._v("#")]),t._v(" Object-Oriented VBA")]),t._v(" "),s("h2",{attrs:{id:"abstraction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#abstraction"}},[t._v("#")]),t._v(" Abstraction")]),t._v(" "),s("h3",{attrs:{id:"abstraction-levels-help-determine-when-to-split-things-up"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#abstraction-levels-help-determine-when-to-split-things-up"}},[t._v("#")]),t._v(" Abstraction levels help determine when to split things up.")]),t._v(" "),s("p",[t._v("Abstraction is achieved by implementing functionality with increasingly detailed code. The entry point of a macro should be a small procedure with a "),s("strong",[t._v("high abstraction level")]),t._v(" that makes it easy to grasp at a glance what's going on:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" SomeForm\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateViewModel\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Show vbModal            \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n        ProcessUserData "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("p",[t._v("The "),s("code",[t._v("DoSomething")]),t._v(" procedure has a high "),s("strong",[t._v("abstraction level")]),t._v(": we can tell that it's displaying a form and creating some model, and passing that object to some "),s("code",[t._v("ProcessUserData")]),t._v(" procedure that knows what to do with it - how the model is created is the job of another procedure:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" CreateViewModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SomeModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Environ"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UserName"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetAvailableItems\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" CreateViewModel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" result\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),s("p",[t._v("The "),s("code",[t._v("CreateViewModel")]),t._v(" function is only responsible for creating some "),s("code",[t._v("ISomeModel")]),t._v(" instance. Part of that responsibility is to acquire an array of "),s("strong",[t._v("available items")]),t._v(" - how these items are acquired is an implementation detail that's abstracted behind the "),s("code",[t._v("GetAvailableItems")]),t._v(" procedure:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" GetAvailableItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n    GetAvailableItems "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DataSheet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AvailableItems"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RefersToRange\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),s("p",[t._v("Here the procedure is reading the available values from a named range on a "),s("code",[t._v("DataSheet")]),t._v(" worksheet. It could just as well be reading them from a database, or the values could be hard-coded: it's an "),s("strong",[t._v("implementation detail")]),t._v(" that's none of a concern for any of the higher abstraction levels.")]),t._v(" "),s("h2",{attrs:{id:"encapsulation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#encapsulation"}},[t._v("#")]),t._v(" Encapsulation")]),t._v(" "),s("h3",{attrs:{id:"encapsulation-hides-implementation-details-from-client-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#encapsulation-hides-implementation-details-from-client-code"}},[t._v("#")]),t._v(" Encapsulation hides implementation details from client code.")]),t._v(" "),s("p",[t._v("The "),s("a",{attrs:{href:"http://stackoverflow.com/documentation/vba/5351/user-forms/19037/handling-queryclose#t=201608091819108848528",target:"_blank",rel:"noopener noreferrer"}},[t._v("Handling QueryClose"),s("OutboundLink")],1),t._v(" example demonstrates encapsulation: the form has a checkbox control, but its client code doesn't work with it directly - the checkbox is an "),s("strong",[t._v("implementation detail")]),t._v(", what the client code needs to know is whether the setting is enabled or not.")]),t._v(" "),s("p",[t._v("When the checkbox value changes, the handler assigns a private field member:")]),t._v(" "),s("blockquote"),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" Type TView\n    IsCancelled "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'other properties skipped for brievety")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" Type\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TView\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SomeOtherSettingInput_Change"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CBool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SomeOtherSettingInput"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("p",[t._v("And when the client code wants to read that value, it doesn't need to worry about a checkbox - instead it simply uses the "),s("code",[t._v("SomeOtherSetting")]),t._v(" property:")]),t._v(" "),s("blockquote"),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeOtherSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),s("p",[t._v("The "),s("code",[t._v("SomeOtherSetting")]),t._v(" property "),s("strong",[t._v("encapsulates")]),t._v(" the checkbox' state; client code doesn't need to know that there's a checkbox involved, only that there's a setting with a Boolean value. By "),s("strong",[t._v("encapsulating")]),t._v(" the "),s("code",[t._v("Boolean")]),t._v(" value, we've added an "),s("strong",[t._v("abstraction layer")]),t._v(" around the checkbox.")]),t._v(" "),s("h3",{attrs:{id:"using-interfaces-to-enforce-immutability"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-interfaces-to-enforce-immutability"}},[t._v("#")]),t._v(" Using interfaces to enforce immutability")]),t._v(" "),s("p",[t._v("Let's push that a step further by "),s("strong",[t._v("encapsulating")]),t._v(" the form's "),s("strong",[t._v("model")]),t._v(" in a dedicated class module. But if we made a "),s("code",[t._v("Public Property")]),t._v(" for the "),s("code",[t._v("UserName")]),t._v(" and "),s("code",[t._v("Timestamp")]),t._v(", we would have to expose "),s("code",[t._v("Property Let")]),t._v(" accessors, making the properties mutable, and we don't want the client code to have the ability to change these values after they're set.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("CreateViewModel")]),t._v(" function in the "),s("strong",[t._v("Abstraction")]),t._v(" example returns an "),s("code",[t._v("ISomeModel")]),t._v(" class: that's our "),s("strong",[t._v("interface")]),t._v(", and it looks something like this:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Timestamp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" UserName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" AvailableItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" AvailableItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeOtherSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeOtherSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),s("p",[t._v("Notice "),s("code",[t._v("Timestamp")]),t._v(" and "),s("code",[t._v("UserName")]),t._v(" properties only expose a "),s("code",[t._v("Property Get")]),t._v(" accessor. Now the "),s("code",[t._v("SomeModel")]),t._v(" class can implement that interface:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Implements")]),t._v(" ISomeModel\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" Type TModel\n    Timestamp "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n    UserName "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    SomeSetting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    AvailableItems "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" Type\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TModel\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_Timestamp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n    ISomeModel_Timestamp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_UserName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    ISomeModel_UserName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_AvailableItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n    ISomeModel_AvailableItems "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" ISomeModel_AvailableItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_SomeSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    ISomeModel_SomeSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" ISomeModel_SomeSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeModel_SomeOtherSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    ISomeModel_SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" ISomeModel_SomeOtherSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Timestamp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),t._v("\n    Timestamp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" Timestamp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" UserName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    UserName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" UserName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" AvailableItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),t._v("\n    AvailableItems "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" AvailableItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByRef")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Variant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("\n    SomeSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" SomeOtherSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" SomeOtherSetting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),s("p",[t._v("The interface members are all "),s("code",[t._v("Private")]),t._v(", and all members of the interface must be implemented for the code to compile. The "),s("code",[t._v("Public")]),t._v(" members are not part of the interface, and are therefore not exposed to code written against the "),s("code",[t._v("ISomeModel")]),t._v(" interface.")]),t._v(" "),s("h3",{attrs:{id:"using-a-factory-method-to-simulate-a-constructor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-factory-method-to-simulate-a-constructor"}},[t._v("#")]),t._v(" Using a "),s("strong",[t._v("Factory Method")]),t._v(" to simulate a constructor")]),t._v(" "),s("p",[t._v("Using a "),s("a",{attrs:{href:"http://stackoverflow.com/documentation/vba/5321/attributes/18932/vb-predeclaredid#t=201608091940164849835",target:"_blank",rel:"noopener noreferrer"}},[t._v("VB_PredeclaredId"),s("OutboundLink")],1),t._v(" attribute, we can make the "),s("code",[t._v("SomeModel")]),t._v(" class have a "),s("strong",[t._v("default instance")]),t._v(", and write a function that works like a type-level ("),s("code",[t._v("Shared")]),t._v(" in VB.NET, "),s("code",[t._v("static")]),t._v(" in C#) member that the client code can call without needing to first create an instance, like we did here:")]),t._v(" "),s("blockquote"),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" CreateViewModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Dim")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SomeModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Environ"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("$")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UserName"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AvailableItems "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetAvailableItems\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" CreateViewModel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" result\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n")])])]),s("p",[t._v("This "),s("strong",[t._v("factory method")]),t._v(" assigns the property values that are read-only when accessed from the "),s("code",[t._v("ISomeModel")]),t._v(" interface, here "),s("code",[t._v("Timestamp")]),t._v(" and "),s("code",[t._v("UserName")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v(" Create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" pTimeStamp "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" pUserName "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("New")]),t._v(" SomeModel\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Timestamp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pTimeStamp\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UserName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pUserName\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Create "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Self\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Function")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Self "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n")])])]),s("p",[t._v("And now we can code against the "),s("code",[t._v("ISomeModel")]),t._v(" interface, which exposes "),s("code",[t._v("Timestamp")]),t._v(" and "),s("code",[t._v("UserName")]),t._v(" as read-only properties that can never be reassigned (as long as the code is written against the interface).")]),t._v(" "),s("h2",{attrs:{id:"polymorphism"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#polymorphism"}},[t._v("#")]),t._v(" Polymorphism")]),t._v(" "),s("h3",{attrs:{id:"polymorphism-is-the-ability-to-present-the-same-interface-for-different-underlying-implementations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#polymorphism-is-the-ability-to-present-the-same-interface-for-different-underlying-implementations"}},[t._v("#")]),t._v(" Polymorphism is the ability to present the same interface for different underlying implementations.")]),t._v(" "),s("p",[t._v("The ability to implement interfaces allows completely decoupling the application logic from the UI, or from the database, or from this or that worksheet.")]),t._v(" "),s("p",[t._v("Say you have an "),s("code",[t._v("ISomeView")]),t._v(" interface that the form itself implements:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" IsCancelled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" Model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" Model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" Show"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("p",[t._v("The form's code-behind could look like this:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Implements")]),t._v(" ISomeView\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" Type TView\n    IsCancelled "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    Model "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" Type\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TView\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_IsCancelled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    ISomeView_IsCancelled "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_Model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ISomeView_Show"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Show vbModal\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" SomeOtherSettingInput_Change"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SomeOtherSetting "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CBool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SomeOtherSettingInput"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'...other event handlers...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" OkButton_Click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hide\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" CancelButton_Click"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hide\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" UserForm_QueryClose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Cancel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CloseMode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Integer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" CloseMode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" VbQueryClose"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vbFormControlMenu "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v("\n        Cancel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Me")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hide\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("p",[t._v("But then, nothing forbids creating another class module that implements the "),s("code",[t._v("ISomeView")]),t._v(" interface "),s("strong",[t._v("without being a user form")]),t._v(" - this could be a "),s("code",[t._v("SomeViewMock")]),t._v(" class:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Option")]),t._v(" Explicit\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Implements")]),t._v(" ISomeView\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" Type TView\n    IsCancelled "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    Model "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" Type\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" this "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" TView\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" IsCancelled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    IsCancelled "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Let")]),t._v(" IsCancelled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_IsCancelled"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Boolean")]),t._v("\n    ISomeView_IsCancelled "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Get")]),t._v(" ISomeView_Model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" ISomeView_Model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" this"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Property")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" ISomeView_Show"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("'do nothing")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("p",[t._v("And now we can change the code that works with a "),s("code",[t._v("UserForm")]),t._v(" and make it work off the "),s("code",[t._v("ISomeView")]),t._v(" interface, e.g. by giving it the form as a parameter instead of instantiating it:")]),t._v(" "),s("div",{staticClass:"language-vb extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vb"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v(" DoSomething"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ByVal")]),t._v(" view "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("As")]),t._v(" ISomeView"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v(" view\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CreateViewModel\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Show\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("If")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IsCancelled "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Then")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n        ProcessUserData "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Model\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("With")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("End")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Sub")]),t._v("\n\n")])])]),s("p",[t._v("Because the "),s("code",[t._v("DoSomething")]),t._v(" method depends on an interface (i.e. an "),s("strong",[t._v("abstraction")]),t._v(") and not a "),s("strong",[t._v("concrete class")]),t._v(" (e.g. a specific "),s("code",[t._v("UserForm")]),t._v("), we can write an automated unit test that ensures that "),s("code",[t._v("ProcessUserData")]),t._v(" isn't executed when "),s("code",[t._v("view.IsCancelled")]),t._v(" is "),s("code",[t._v("True")]),t._v(", by making our test create a "),s("code",[t._v("SomeViewMock")]),t._v(" instance, setting its "),s("code",[t._v("IsCancelled")]),t._v(" property to "),s("code",[t._v("True")]),t._v(", and passing it to "),s("code",[t._v("DoSomething")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"testable-code-depends-on-abstractions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#testable-code-depends-on-abstractions"}},[t._v("#")]),t._v(" Testable code depends on abstractions")]),t._v(" "),s("p",[t._v("Writing unit tests in VBA can be done, there are add-ins out there that even integrate it into the IDE. But when code is "),s("strong",[t._v("tightly coupled")]),t._v(" with a worksheet, a database, a form, or the file system, then the unit test starts requiring an actual worksheet, database, form, or file system - and these "),s("strong",[t._v("dependencies")]),t._v(" are new out-of-control failure points that testable code should isolate, so that unit tests "),s("strong",[t._v("don't")]),t._v(" require an actual worksheet, database, form, or file system.")]),t._v(" "),s("p",[t._v("By writing code against interfaces, in a way that allows test code to "),s("strong",[t._v("inject")]),t._v(" stub/mock implementations (like the above "),s("code",[t._v("SomeViewMock")]),t._v(' example), you can write tests in a  "controlled environment", and simulate what happens when every single one of the 42 possible permutations of user interactions on the form\'s data, without even once displaying a form and manually clicking on a form control.')])])}),[],!1,null,null,null);e.default=n.exports}}]);